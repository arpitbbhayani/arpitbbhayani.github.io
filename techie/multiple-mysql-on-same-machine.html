<div class="ui hidden divider"></div>

<div itemscope="" itemtype="http://schema.org/BlogPosting">
    <article>
        <h1 itemprop="name headline" class="ui huge header center aligned">
            <b>Multiple MySQL versions running on one server</b>
        </h1>
        
        <div itemprop="image" itemscope itemtype="https://schema.org/ImageObject">
            <meta itemprop="url" content="https://arpitbhayani.me/static/images/multiple-mysql/multiple-mysql.jpg" />
            <img itemprop="image" class="ui centered large image" src="https://arpitbhayani.me/static/images/multiple-mysql/multiple-mysql.jpg" alt="Multiple MySQL versions running on one server" />
        </div>
        
        <div class="ui hidden section divider"></div>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-9220578038638789"
     data-ad-slot="2902722754"
     data-ad-format="auto"></ins>
<script>
  (adsbygoogle = window.adsbygoogle || []).push({});
</script>
<div class="ui hidden section divider"></div>

        <div itemprop="articleBody">
            <p>There are many situations where there is a require where you need to run multiple instances of MySQL on same machine.</p>

<p>Some situations are:</p>

<ul>
  <li>test a new MySQL release while leaving an existing production setup undisturbed</li>
  <li>give different users access to different <code>mysqld</code> servers that they manage themselves</li>
</ul>

<h2 id="problem-description">Problem description</h2>
<p>I have a machine having 5 products already setup. All products are using MySQL 5.5 as its default database. Now its time to upgrade all but one product to use MySQL 5.6. The table below shows the before and after version requirements of MySQL for various products. Looking at the table we find that all products except product C wants to use MySQL 5.6.</p>

<table class="ui small table">
<thead>
    <th>Products</th>
    <th>MySQL version before</th>
    <th>MySQL version after</th>
</thead>
<tbody>
     <tr>
         <td>Product A</td>
         <td>MySQL 5.5</td>
         <td>MySQL 5.6</td>
     </tr>
     <tr>
         <td>Product B</td>
         <td>MySQL 5.5</td>
         <td>MySQL 5.6</td>
     </tr>
     <tr class="negative">
         <td>Product C</td>
         <td>MySQL 5.5</td>
         <td>MySQL 5.5</td>
     </tr>
     <tr>
         <td>Product D</td>
         <td>MySQL 5.5</td>
         <td>MySQL 5.6</td>
     </tr>
     <tr>
         <td>Product E</td>
         <td>MySQL 5.5</td>
         <td>MySQL 5.6</td>
     </tr>
</tbody>
</table>

<p>Since all but one products require MySQL 5.6, so lets install it first and then we will work to figure out a way to install MySQL 5.5 as well.</p>

<h2 id="installing-mysql-56">Installing MySQL 5.6</h2>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span></span>sudo apt-get update
sudo apt-get install mysql-server-5.6 mysql-server-core-5.6 mysql-client-5.6 mysql-client-core-5.6</code></pre></figure>

<p>At this point we have MySQL 5.6 listening at port <code>3306</code> (default port)</p>

<h2 id="approach-to-solution">Approach to solution</h2>
<p>There are several approaches with which you can achieve multiple MySQL versions running in same machine. Some of them are</p>

<ul>
  <li>Use binaries of specific version</li>
  <li>Build everything from MySQL source</li>
</ul>

<h2 id="issues-in-above-approaches">Issues in above approaches:</h2>
<p>Evidently we can only have one version of MySQL setup on the machine using default installation procedure with <code>apt-get</code>. Hence if we try to install one version over other then it will replace the first version and will retain the second version. Hence we cannot have 2 versions of MySQL with default installation procedure.</p>

<p>Building everything from scratch involves a lot of complications at source level. In order to debug any issues that might arise, you should be aware what happens in various scripts/commands that you run. I did spend a day in building from the source but it eventually turned out to be complete waste of time, efforts and debugging.</p>

<h2 id="docker-to-the-rescue">Docker to the rescue</h2>
<p>If we had a container in which we have a MySQL 5.5 installed and if we can publish the container’s port(s) to the host, then we can connect to container’s MySQL just like a local database.</p>

<p>We can have all of the above with <strong>Docker</strong>. If you dont know what docker is, please read this official <a href="https://www.docker.com/what-docker">What is Docker</a>.</p>

<h3 id="installing-docker">Installing Docker</h3>
<p>To install docker on your machine execute following command on your shell.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span></span>curl -sSL https://get.docker.com/ <span class="p">|</span> sh</code></pre></figure>

<h3 id="spin-off-mysql-55-container">Spin off MySQL 5.5 container</h3>
<p>Execute following command and this will download MySQL 5.5 image and will spin off the container. This container will have MySQL 5.5 installed on port <code>3306</code>. But on host machine port <code>3310</code> will be forwarded.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span></span>sudo docker run --name mysql-55-container -p <span class="m">127</span>.0.0.1:3310:3306 <span class="se">\</span>
     -e <span class="nv">MYSQL_ROOT_PASSWORD</span><span class="o">=</span>rootpassword -d mysql:5.5</code></pre></figure>

<p><em>NOTE: Password for root user is rootpassword, you can change it to anything.</em></p>

<h3 id="connect-to-mysql-55">Connect to MySQL 5.5</h3>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span></span>mysql -u root -p --host<span class="o">=</span><span class="m">127</span>.0.0.1 --port<span class="o">=</span><span class="m">3310</span></code></pre></figure>

<h3 id="connect-to-mysql-56">Connect to MySQL 5.6</h3>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span></span>mysql -u root -p</code></pre></figure>

<p><strong>And voila! you have both My SQL 5.5 and MySQL 5.6 installed and running on same machine.</strong></p>

<p>Now you can configure your application product C to use host <code>127.0.0.1</code> and port <code>3310</code> and thus you have products A, B, D and E running on MySQL 5.6 and product C running on MySQL 5.5.</p>

        </div>
    </article>
</div>

<div class="ui hidden section divider"></div>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-9220578038638789"
     data-ad-slot="2902722754"
     data-ad-format="auto"></ins>
<script>
  (adsbygoogle = window.adsbygoogle || []).push({});
</script>
<div class="ui hidden section divider"></div>



    <div class="ui basic segment" style="background: #FFF">
    <div id="disqus_thread"></div>
</div>

<script>
/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/

var disqus_config = function () {
this.page.url = "https://arpitbhayani.me/techie/multiple-mysql-on-same-machine.html";  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = "/techie/multiple-mysql-on-same-machine.html"; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = '//arpitbbhayani.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


