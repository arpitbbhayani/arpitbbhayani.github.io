<div class="ui hidden divider"></div>

<div itemscope="" itemtype="http://schema.org/BlogPosting">
    <article>
        <h1 itemprop="name headline" class="ui huge header center aligned">
            <b>Why MongoDB's cursor.skip() is slow?</b>
        </h1>
        
        <div itemprop="image" itemscope itemtype="https://schema.org/ImageObject">
            <meta itemprop="url" content="https://arpitbhayani.me/static/images/mongodb-pagination/cursor-skip-slow.jpg" />
            <img itemprop="image" class="ui centered large image" src="https://arpitbhayani.me/static/images/mongodb-pagination/cursor-skip-slow.jpg" alt="Why MongoDB's cursor.skip() is slow?" />
        </div>
        
        <div class="ui hidden section divider"></div>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-9220578038638789"
     data-ad-slot="2902722754"
     data-ad-format="auto"></ins>
<script>
  (adsbygoogle = window.adsbygoogle || []).push({});
</script>
<div class="ui hidden section divider"></div>

        <div itemprop="articleBody">
            <p>MongoDB’s cursor object has a method called <code>skip</code>, which as per <a href="https://docs.mongodb.com/manual/reference/method/cursor.skip/#definition">documentation and definition</a>, controls where MongoDB begins returning results. Thus in combination with function <a href="https://docs.mongodb.com/manual/reference/method/cursor.limit/">limit</a>, one can easily have paginated results.</p>

<p>I have written a blog post on <a href="/techie/fast-and-efficient-pagination-in-mongodb.html">how you can have Fast and Efficient Pagination in MongoDB</a>.</p>

<p>But while going through the documentation of skip, there is something interesting to notice. There is a small warning in <a href="https://docs.mongodb.com/manual/reference/method/cursor.skip/#behavior">MongoDB documentation</a>, that states</p>

<blockquote>
  <p>The <code>cursor.skip()</code> method is often expensive because it requires the server to walk from the beginning of the collection or index to get the offset or skip position before beginning to return results. As the offset (e.g. <code>pageNumber</code> above) increases, <code>cursor.skip()</code> will become slower and more CPU intensive. With larger collections, <code>cursor.skip()</code> may become IO bound.</p>
</blockquote>

<p>In short, MongoDB has to iterate over documents to skip them. Thus when collection or result set is huge and you need to skip documents for pagination, the call to <code>cursor.skip</code> will be expensive. While going through the source code of <code>skip</code> I found out that it does not use any index and hence gets slower when result set increases in size.</p>

<p>This also implies that if you use <code>skip</code>  then the “skipping speed” will not improve even if you index the field.</p>

<p>But what if the size of result set is small? is calling <code>skip</code> still a terrible idea?
If skip was so terrible, then MongoDB team and community must had taken that decision long back. But they haven’t … why?</p>

<p>Because it is very efficient and fast for smaller result set. I have taken this opportunity to <a href="/techie/benchmark-and-compare-pagination-approach-in-mongodb.html">benchmark and compare</a> the <a href="/techie/fast-and-efficient-pagination-in-mongodb.html">two approach for pagination</a> and there I found out skip and limit based pagination works well for smaller result sets.</p>

<p>In conclusion, skip is not as bad one might think. But you must understand your use case well so as to make an informed decision.</p>

        </div>
    </article>
</div>

<div class="ui hidden section divider"></div>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-9220578038638789"
     data-ad-slot="2902722754"
     data-ad-format="auto"></ins>
<script>
  (adsbygoogle = window.adsbygoogle || []).push({});
</script>
<div class="ui hidden section divider"></div>



    <div class="ui basic segment" style="background: #FFF">
    <div id="disqus_thread"></div>
</div>

<script>
/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/

var disqus_config = function () {
this.page.url = "https://arpitbhayani.me/techie/mongodb-cursor-skip-is-slow.html";  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = "/techie/mongodb-cursor-skip-is-slow.html"; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = '//arpitbbhayani.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


